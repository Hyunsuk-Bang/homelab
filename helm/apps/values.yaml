
namespace: hbang-argocd

apps:
  argocd:
    enabled: true
    targetRevision: 8.2.7
    name: argocd
    chart: argo-cd
    namespace: hbang-argocd
    repoURL: https://argoproj.github.io/argo-helm
    values:
      namespaceOverride: hbang-argocd
      redis-ha:
        enabled: true
      controller:
        replicas: 1
      server:
        replicas: 2
      repoServer:
        replicas: 2
      applicationSet:
        replicas: 2
      global:
        domain: argocd.hbang-k8s.com
      configs:
        params:
          server.insecure: true
      server:
        ingress:
          enabled: true
          ingressClassName: cloudflare-tunnel

  certManager:
    enabled: true
    targetRevision: 1.18.2
    repoURL: https://charts.jetstack.io
    chart: cert-manager
    name: cert-manager
    namespace: hbang-resources
    values:
      replicaCount: 2
      webhook:
        replicaCount: 2
      cainjector:
        replicaCount: 2

  cloudflareTunnelIngressController:
    enabled: true
    repoURL: https://helm.strrl.dev
    chart:  cloudflare-tunnel-ingress-controller
    targetRevision: 0.0.*
    name: cloudflare-tunnel-ingress-controller
    namespace: hbang-resources
    values:
      cloudflare:
        secretRef:
          name: cloudflare-external-secret
          accountIDKey: cloudflareAccountID
          tunnelNameKey: cloudflareTunnelName
          apiTokenKey: cloudflareAPIToken
      ingressClass:
        name: cloudflare-tunnel
        controllerValue: strrl.dev/cloudflare-tunnel-ingress-controller
        isDefaultClass: true
      image:
        repository: cr.strrl.dev/strrl/cloudflare-tunnel-ingress-controller
        pullPolicy: IfNotPresent
        tag: ""
      replicaCount: 3

  cilium:
    enabled: true
    targetRevision: 1.18.0
    name: cilium
    chart: cilium
    namespace: kube-system
    repoURL: https://helm.cilium.io
    values: {}

  dex:
    enabled: false
    targetRevision: 0.23.0
    name: dex
    chart: dex
    namespace: hbang-resources
    repoURL: https://charts.dexidp.io
    values:
      config:
        storage:
          type: memory
        ingress:
          enabled: true
          hosts:
          - host: dex.hbang-k8s.com
            paths:
            - path: /

  externalSecrets:
    enabled: true
    repoURL: https://external-secrets.io
    chart: external-secrets
    targetRevision: 0.19.1
    serverSideApply: true
    namespace: hbang-resources
    name: external-secrets
    values:
      replicaCount: 2
      certController:
        replicaCount: 2
      webhook:
        replicaCount: 2

  ejbca:
    enabled: false
    repoURL: https://keyfactor.github.io/ejbca-community-helm
    targetRevision: 9.1.1
    chart: ejbca
    name: ejbca
    namespace: hbang-ejbca
    values:
      ejbca:
        useEphemeralH2Database: false
        env:
          DATABASE_JDBC_URL: jdbc:postgresql://postgresql-server:5432/ejbcadb
        envRaw:
        - name: DATABASE_PASSWORD
          valueFrom:
           secretKeyRef:
             name: ejbca-db-credentials
             key: database_password
        - name: DATABASE_USER
          valueFrom:
           secretKeyRef:
             name: ejbca-db-credentials
             key: database_user
      ingress:
        enabled: true
        className: cloudflare-tunnel
        hosts:
        - ejbca.hbang-k8s.com
      replicaCount: 2

  ejbcaPostgresCluster:
    enabled: false #postgresOperator must be enabled
    type: helm
    repoURL: https://cloudnative-pg.github.io/charts
    chart: cluster
    targetRevision: 0.3.1
    name: ejbca-postgres-cluster
    namespace: hbang-ejbca
    values:
      type: postgresql
      cluster:
        storage:
          size: 8Gi
          storageClass: local-storage

  localStorageClass:
    enabled: true
    type: helm
    repoURL: https://github.com/Hyunsuk-Bang/homelab.git
    name: local-storage-class
    path: helm/local-storage-class
    targetRevision: master

  openebs:
    enabled: true
    type: helm
    repoURL: https://openebs.github.io/openebs
    chart: openebs
    targetRevision: 4.3.2
    name: openebs
    namespace: hbang-resources
    values:
      minio:
        enabled: false
      loki:
        enabled: false
      alloy:
        enabled: false
      engines:
        local:
          zfs:
            enabled: false
          lvm:
            enabled: false

  postgresOperator:
    enabled: false
    type: helm
    repoURL: https://cloudnative-pg.github.io/charts
    chart: cloudnative-pg
    targetRevision: 0.25.0
    serverSideApply: true
    name: cloudnative-pg-operator
    namespace: hbang-resources
    values:
      crd:
        create: true
      replicaCount: 2

  secretAddons:
    enabled: true
    type: helm
    repoURL: https://github.com/Hyunsuk-Bang/homelab.git
    name: secret-addons
    path: helm/secret-addons
    targetRevision: master
    namespace:  hbang-resources

  reflector:
    enabled: true
    type: helm
    repoURL: https://emberstack.github.io/helm-charts
    chart: reflector
    targetRevision: 9.1.25
    name: reflector
    namespace: hbang-resources
    values: {}
