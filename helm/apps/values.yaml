
namespace: argocd

apps:
  argocd:
    enabled: true
    targetRevision: 8.2.7
    name: argocd
    chart: argo-cd
    namespace: argocd
    repoURL: https://argoproj.github.io/argo-helm
    values:
      namespaceOverride: argocd
      redis-ha:
        enabled: true
      controller:
        replicas: 1
      repoServer:
        replicas: 2
      applicationSet:
        replicas: 2
      global:
        domain: argocd.hbang-k8s.com
      configs:
        params:
          server.insecure: true
      server:
        replicas: 2
        ingress:
          enabled: true
          ingressClassName: cloudflare-tunnel

  certManager:
    enabled: true
    targetRevision: 1.18.2
    repoURL: https://charts.jetstack.io
    chart: cert-manager
    name: cert-manager
    namespace: hbang-resources
    values:
      installCRDs: true
      extraArgs:
      - --dns01-recursive-nameservers=1.1.1.1:53,9.9.9.9:53
      - --dns01-recursive-nameservers-only
      podDnsPolicy: None
      podDnsConfig:
        nameservers:
        - "1.1.1.1"
        - "9.9.9.9"
      replicaCount: 2
      webhook:
        replicaCount: 2
      cainjector:
        replicaCount: 2

  cloudflareTunnelIngressController:
    enabled: true
    repoURL: https://helm.strrl.dev
    chart:  cloudflare-tunnel-ingress-controller
    targetRevision: 0.0.*
    name: cloudflare-tunnel-ingress-controller
    namespace: hbang-resources
    values:
      cloudflare:
        secretRef:
          name: cloudflare-external-secret
          accountIDKey: cloudflareAccountID
          tunnelNameKey: cloudflareTunnelName
          apiTokenKey: cloudflareAPIToken
      ingressClass:
        name: cloudflare-tunnel
        controllerValue: strrl.dev/cloudflare-tunnel-ingress-controller
        isDefaultClass: true
      image:
        repository: cr.strrl.dev/strrl/cloudflare-tunnel-ingress-controller
        pullPolicy: IfNotPresent
        tag: ""
      replicaCount: 3

  cilium:
    enabled: true
    targetRevision: 1.18.2
    name: cilium
    chart: cilium
    namespace: kube-system
    repoURL: https://helm.cilium.io
    values:
      kubeProxyReplacement: true
      l2announcements:
        enabled: true
      ingressController:
        enabled: true
        default: true

  dex:
    enabled: false
    targetRevision: 0.23.0
    name: dex
    chart: dex
    namespace: hbang-resources
    repoURL: https://charts.dexidp.io
    values:
      config:
        storage:
          type: memory
        ingress:
          enabled: true
          hosts:
          - host: dex.hbang-k8s.com
            paths:
            - path: /

  externalSecrets:
    enabled: true
    repoURL: https://external-secrets.io
    chart: external-secrets
    targetRevision: 0.19.1
    serverSideApply: true
    namespace: hbang-resources
    name: external-secrets
    syncOptions:
    - ServerSideApply=true
    values:
      replicaCount: 2
      certController:
        replicaCount: 2
      webhook:
        replicaCount: 2

  localStorageClass:
    enabled: false
    type: helm
    repoURL: https://github.com/Hyunsuk-Bang/homelab.git
    name: local-storage-class
    path: helm/local-storage-class
    targetRevision: master

  nfsCsiDriver:
    enabled: false
    type: helm
    repoURL: https://raw.githubusercontent.com/kubernetes-csi/csi-driver-nfs/master/charts
    chart: csi-driver-nfs
    targetRevision: 4.9.0
    name: csi-driver-nfs
    namespace: hbang-resources
    values:
      storageClass:
        create: true
        name: nfs-csi
        annotations:
          storageclass.kubernetes.io/is-default-class: "true"
        parameters:
          server: 192.168.1.69
          share: /srv/nfs/proxmox
          mountPermissions: "0"
        reclaimPolicy: Delete
        volumeBindingMode: Immediate
        mountOptions:
        - nfsvers=4.1

  openebs:
    enabled: true
    type: helm
    repoURL: https://openebs.github.io/openebs
    chart: openebs
    targetRevision: 4.3.2
    values:
      engines:
        local:
          lvm:
            enabled: true
          zfs:
            enabled: false
        replicated:
          mayastor:
            enabled: false

  prometheusStack:
    enabled: true
    type: helm
    repoURL: https://prometheus-community.github.io/helm-charts
    chart: kube-prometheus-stack
    targetRevision: 77.12.0
    name: prometheus-stack
    namespace: prometheus
    syncOptions:
    - ServerSideApply=true
    values:
      prometheus:
        ingress:
          enabled: true
          ingressClassName: cloudflare-tunnel
          hosts:
          - prometheus.hbang-k8s.com
      grafana:
        ingress:
          enabled: true
          hosts:
          - monitoring.hbang-k8s.com


  postgresOperator:
    enabled: false
    type: helm
    repoURL: https://cloudnative-pg.github.io/charts
    chart: cloudnative-pg
    targetRevision: 0.25.0
    serverSideApply: true
    name: cloudnative-pg-operator
    namespace: hbang-resources
    syncOptions:
    - ServerSideApply=true
    values:
      crd:
        create: true
      replicaCount: 2

  secretAddons:
    enabled: true
    type: helm
    repoURL: https://github.com/Hyunsuk-Bang/homelab.git
    name: secret-addons
    path: helm/secret-addons
    targetRevision: master
    namespace:  hbang-resources

  vault:
    enabled: false
    type: helm
    repoURL: https://helm.releases.hashicorp.com
    chart: vault
    targetRevision: 0.30.1
    name: vualt
    namespace: hbang-resources
    values:
      server:
        ha:
          enabled: true
          replicas: 3
          raft:
            enabled: true
            setNodeId: true
      ingress:
        enabled: true
        ingressClassName: cloudflare-tunnel
        hosts:
        -  host: vault.hbang-k8s.com

  reflector:
    enabled: true
    type: helm
    repoURL: https://emberstack.github.io/helm-charts
    chart: reflector
    targetRevision: 9.1.25
    name: reflector
    namespace: hbang-resources
    values: {}
